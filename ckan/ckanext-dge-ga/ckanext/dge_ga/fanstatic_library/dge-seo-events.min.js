/*
* Copyright (C) 2022 Entidad Pública Empresarial Red.es
*
* This file is part of "dge_ga (datos.gob.es)".
*
* This program is free software: you can redistribute it and/or modify
* it under the terms of the GNU General Public License as published by
* the Free Software Foundation, either version 2 of the License, or
* (at your option) any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
* GNU General Public License for more details.
*
* You should have received a copy of the GNU General Public License
* along with this program. If not, see <http://www.gnu.org/licenses/>.
*/

$(document).ready(function(){var b=$("ul.breadcrumb").find("li");if(b.length<2){return;}var a=b[2].innerText;a=formatDataLayerValue(a);$("#search-block-form").submit(function(){if($("#edit-search-filter-ckan").is(":checked")){var e=$("#edit-search-block-form--2").val();e=e===""?"campo vacio":formatDataLayerValue(e);dataLayer.push({event_action:"buscar",event_category:a,termino_busqueda:e,event_label:e,event:"ev.buscar"})}});$("#simplenews-block-form-21").submit(function(){if($("#edit-condiciones").is(":checked")){var e="suscribirse";if($("#edit-action2-unsubscribe").is(":checked")){e="darse de baja"}dataLayer.push({event_action:"accion_newsletter",event_category:a,accionNewsletter:e,event_label:e,event:"ev.accion_newsletter"})}});if($("#dataset-resources").length){$(".resource-item").on("click","a.btn-primary",function(){var i=$(this).closest(".resource-item");var j=formatDataLayerValue(i.find(".resource-item-name").find("strong")[0].innerText);var g=formatDataLayerValue(i.find(".format")[0].innerText);var f,h;var e=$(this).find("i")[0];if($(e).hasClass("icon-download")){f="descargar";h="ev.descargar_documento"}else{if($(e).hasClass("icon-external-link")){f="acceder";h="ev.acceder_recurso"}}dataLayer.push({event_action:f,event_category:a,nombre_distribucion:j,formato_distribucion:g,event_label:j+"|"+g,event:h})});if(localStorage.getItem("datasetAdded")!=null){var d=localStorage.getItem("sectores");if(d!=null){dataLayer.push({event_action:"subir_datos",event_category:a,sectores:d,event_label:d,event:"ev.subir_datos"});localStorage.removeItem("sectores")}localStorage.removeItem("datasetAdded")}}else{if($("#dataset-search-form").length){$("#dataset-search-form").submit(function(){var e=$("#dataset-search-form").find("input").val();e=e===""?"campo vacio":formatDataLayerValue(e);dataLayer.push({event_action:"buscar",event_category:a,termino_busqueda:e,event_label:e,event:"ev.buscar"})})}else{if($("#dataset-edit").length){$("#dataset-edit").submit(function(){var f=$("#field-theme option:selected");var e=$.map(f,function(i){return $(i).val()});var k="";for(var h=0;h<e.length;h++){var j=e[h].split("/");var g=j[j.length-1];g=g.replace("-"," ");k+=h<e.length-1?g+":":g}localStorage.setItem("sectores",k)})}else{if($("#resource-edit").length){$("#resource-edit").submit(function(){if($(".btn-primary")[0].name==="save"){localStorage.setItem("datasetAdded","true")}})}else{if($("#swagger-ui-container").length){$(".site-content__wrapper").on("click","input.submit",function(){var f=$(this).closest(".operations");var g=f.find("span.path")[0].innerText;var e=f.find(".response-content-type").find("select").val();dataLayer.push({event_action:"acceder_api",event_category:a,funcion_api:g,formato_respuesta:e,event_label:g+"|"+e,event:"ev.acceder_api"})})}else{if($("#yasqe").length){$(".site-content__wrapper").on("click","button.yasr_downloadIcon",function(){var e=formatDataLayerValue($("div.yasr_btnGroup").find(".selected")[0].innerText);dataLayer.push({event_action:"acceder_sparql",event_category:a,formato_descarga:e,event_label:e,event:"ev.acceder_sparql"})})}else{if($(".dge-dashboard").length){var c={div:"",export_main:""};$(".dge-dashboard").on("mouseenter","a",function(){if($(this).parent().children("ul").length){var e=$(this).closest(".export-main");if(e.length){c.export_main=c.export_main[0];var f=$(e).closest(".chartdiv");if(!f.length){f=$(e).closest(".smallchartdiv")}c.div=$(f).parent("div")[0];c.export_main=e}}});$(document).on("click","a",function(){if($(this).closest(".export-main").length){var i=$(c.export_main).find("li");var h=$([i[0],i[5]]).find("li.active")[0];if(h!==undefined){var j=formatDataLayerValue(this.innerText);if($(c.div).hasClass("chartdiv2")){var g=$(c.div).parent().find(".chartdiv2");var f=$(g[0]).is(c.div)?0:1;c.div=$(c.div).parent().find(".halfwidth")[f]}var e=formatDataLayerValue($(c.div).find("strong")[0].innerText);dataLayer.push({event_action:"acceder_cuadro_mando",event_category:a,titulo_grafica:e,formato_descarga:j,event_label:e+"|"+j,event:"ev.acceder_cuadro_mando"})}}})}}}}}}}});